window.frontJs = (function(e, r, t) {
    'use strict'
    function n(e) {
        if (!e.message) return !0
        var r = w.composeScriptErrorData(
            p,
            e.message,
            e.filename,
            e.lineno,
            e.colno,
            e.error
        )
        w.checkCrossOrigin(e.filename, L.exclude) && L.behaviour & l && i(p, r)
    }
    function o(e) {
        var r = e.target.tagName,
            t = e.target.src || e.target.href
        if (!(w.checkCrossOrigin(t, L.exclude) && L.behaviour & f && t))
            return !0
        if ('load' === e.type) {
            if (w.checkCrossOrigin(t, L.origin)) {
                var n = w.composeResourceErrorData(_, r, t)
                i(v, n)
            }
        } else
            'error' === e.type &&
                ((n = w.composeResourceErrorData(h, r, t)), i(v, n))
    }
    function a(e) {
        var r = e.target
        if (
            !(
                w.checkCrossOrigin(r.tracker._request_url, L.exclude) &&
                L.behaviour & g
            )
        )
            return !0
        if ('readystatechange' === e.type) {
            var t = [
                '_time_init',
                '_time_open',
                '_time_send',
                '_time_load',
                '_time_done'
            ]
            if (
                (t[r.readyState] && (r.tracker[t[r.readyState]] = w.getTime()),
                4 === r.readyState)
            ) {
                r.tracker._status = r.status
                var n = w.calculateTrackerTiming(r.tracker)
                if (w.checkCrossOrigin(r.tracker._request_url, L.origin)) {
                    var o = w.composeXHRErrorData(
                        C,
                        r.tracker._request_url,
                        { status: r.tracker._status },
                        n
                    )
                    i(k, o)
                }
                ;(n.send || n.load || n.total || r.tracker._status) &&
                    ((o = w.composeXHRErrorData(
                        y,
                        r.tracker._request_url,
                        { status: r.tracker._status },
                        n
                    )),
                    i(k, o))
            }
        } else
            'error' === e.type
                ? ((r.tracker._status = r.status),
                  (o = w.composeXHRErrorData(
                      D,
                      r.tracker._request_url,
                      { status: r.tracker._status },
                      n
                  )),
                  i(k, o))
                : 'timeout' === e.type &&
                  ((r.tracker._status = r.status),
                  (o = w.composeXHRErrorData(
                      code_timeout,
                      r.tracker._request_url,
                      { status: r.tracker._status },
                      n
                  )),
                  i(k, o))
    }
    function i(e, r) {
        var t = w.composeTrackerData(e, r)
        ;(t.currentURL = w.getCurrentURL()),
            (t.refererURL = w.getRefererURL()),
            (t.viewPort = w.getViewPortSize()),
            (t.userAgent = w.getUserAgent()),
            (t.clientID = w.getClientID()),
            (t.sessionID = w.getSessionID()),
            (t.messageID = e === E ? q : w.getGUID()),
            (t.token = L.token),
            (t.version = m),
            (t.userData = L.userData),
            s(t)
    }
    function s(r) {
        var t = JSON.stringify(r),
            n = new e.XMLHttpRequest()
        n.open('POST', c, !0), n.send(t)
    }
    var c = 'https://collecter.frontjs.com/',
        u = 'https://static.frontjs.com/dist/current/tracker.min.js',
        m = '0.1.0',
        l = 1,
        f = 2,
        g = 4,
        d = 8,
        p = 256,
        v = 512,
        h = 513,
        _ = 514,
        k = 768,
        D = 769,
        code_timeout = 770,
        y = 771,
        C = 772,
        E = 1024,
        I = function(e, r) {
            r = r || ''
            var t = {
                1001: 'Invalid token',
                1002: 'Invalid behaviour settings',
                1003: 'Invalid origin settings',
                1004: 'Invalid exclude settings',
                1005: 'Invalid user data',
                4e3: 'Bad configuration! Fail to start!',
                4001: 'window.frontJs is already defined, Fail to start!'
            }
            t[e] &&
                console.warn(
                    [
                        'Error(frontjs):',
                        t[e],
                        '(CODE' + e + ')',
                        'See https://frontjs.com/error/' +
                            e +
                            '/' +
                            encodeURIComponent(r)
                    ].join(' ')
                )
        }
    if (e.frontJs) return I(4001), e.frontJs
    var R = {
            tokenChecker: function(e) {
                return e && e.match(/^\w{32}$/) ? 0 : 1
            },
            behaviourChecker: function(e) {
                return e <= (l | f | g | d) ? 0 : 1
            },
            urlSettingChecker: function(e) {
                e = e || []
                for (var r = 0; r < e.length; r++)
                    if ('string' == typeof e[r]);
                    else if (!e[r].test) return e[r]
                return 0
            },
            KVArrayChecker: function(e) {
                e = e || {}
                for (var r in e) if ('object' == typeof e[r]) return r
                return 0
            }
        },
        w = {
            KVArrayCopy: function(e) {
                var r = {}
                for (var t in e) r[t] = e[t]
                return r
            },
            uriArrayCopy: function(e) {
                e = e || []
                for (var r = [], t = 0; t < e.length; t++)
                    'string' == typeof e[t]
                        ? r.push(e[t])
                        : r.push(new RegExp(e[t].source, e[t].flag))
                return r
            },
            getTime: function() {
                return new Date().getTime()
            },
            getGUID: function() {
                var e = [
                        '0',
                        '1',
                        '2',
                        '3',
                        '4',
                        '5',
                        '6',
                        '7',
                        '8',
                        '9',
                        'a',
                        'b',
                        'c',
                        'd',
                        'e',
                        'f'
                    ],
                    r = w.getTime().toString(16)
                for (r = '0' + r; r.length < 16; ) r = 'f' + r
                for (; r.length < 32; ) r += e[Math.floor(16 * Math.random())]
                return r
            },
            addSlashes: function(e) {
                var r = /(\.|\\|\/|\||\+|\$|\^)/g
                return e.replace(r, '\\$1')
            },
            filterTrace: function(e) {
                var r = new RegExp('((?!\n).)*' + w.addSlashes(u) + '.*\n', 'g')
                return e.replace(r, '')
            },
            getUserAgent: function() {
                return e.navigator.userAgent
            },
            getCurrentURL: function() {
                return e.location.href
            },
            getRefererURL: function() {
                return r.referrer
            },
            getViewPortSize: function() {
                return {
                    w: e.innerWidth,
                    h: e.innerHeight,
                    r: e.devicePixelRatio
                }
            },
            getClientID: function() {
                return e.localStorage
                    ? (e.localStorage.getItem('frontjs:client:id') ||
                          e.localStorage.setItem(
                              'frontjs:client:id',
                              w.getGUID()
                          ),
                      e.localStorage.getItem('frontjs:client:id'))
                    : w.getGUID()
            },
            getSessionID: function() {
                return e.sessionStorage
                    ? (e.sessionStorage.getItem('frontjs:session:id') ||
                          e.sessionStorage.setItem(
                              'frontjs:session:id',
                              w.getGUID()
                          ),
                      e.sessionStorage.getItem('frontjs:session:id'))
                    : w.getGUID()
            },
            checkCrossOrigin: function(e, r) {
                if (r) {
                    e = e || ''
                    for (var t = !1, n = 0; n < r.length; n++)
                        e.match(r[n]) && (t |= !0)
                    return !t
                }
                return !1
            },
            checkTimingSlow: function(e, r) {
                return (
                    !!r &&
                    ((e.send > r.sned && r.sned > 0) ||
                        (e.load > r.load && r.load > 0) ||
                        (e.total > r.total && r.total > 0))
                )
            },
            calculateTrackerTiming: function(e) {
                return e._time_done &&
                    e._time_load &&
                    e._time_send &&
                    e._time_done
                    ? {
                          send: e._time_send - e._time_open,
                          load: e._time_load - e._time_send,
                          total: e._time_done - e._time_open
                      }
                    : { send: 0, load: 0, total: 0 }
            },
            composeTrackerData: function(e, r) {
                return { type: e, data: r }
            },
            composeScriptErrorData: function(e, r, t, n, o, a) {
                return (
                    (a = a && a.stack ? a.stack.toString() : ''),
                    (a = w.filterTrace(a)),
                    {
                        message: e,
                        detail: {
                            err: r,
                            file: t,
                            line: n,
                            column: o,
                            trace: a
                        }
                    }
                )
            },
            composeXHRErrorData: function(e, r, t, n) {
                return {
                    message: e,
                    detail: { requestURL: r, responseData: t, timing: n }
                }
            },
            composeResourceErrorData: function(e, r, t) {
                return { message: e, detail: { tagname: r, resourceURL: t } }
            },
            composePerformaceData: function(e, r) {
                return { message: e, detail: r }
            }
        },
        L = (function(r) {
            var t = {},
                n = !0
            if (
                (R.tokenChecker(r.token)
                    ? (I(1001), (n &= !1))
                    : (t.token = r.token.toString()),
                R.behaviourChecker(r.behaviour)
                    ? (I(1002), (n &= !1))
                    : ((t.behaviour = parseInt(r.behaviour)),
                      t.behaviour || (t.behaviour = l | f | g | d)),
                R.urlSettingChecker(r.origin))
            ) {
                var o = R.urlSettingChecker(r.behaviour)
                I(1003, o), (n &= !1)
            } else
                (t.origin = w.uriArrayCopy(r.origin)),
                    t.origin.push(e.location.origin),
                    t.origin.push(/^((?!:\/\/).)*$/),
                    t.origin.push(u),
                    t.origin.push(c)
            return (
                R.urlSettingChecker(r.exclude)
                    ? ((o = R.urlSettingChecker(r.exclude)),
                      I(1004, o),
                      (n &= !1))
                    : ((t.exclude = w.uriArrayCopy(r.exclude)),
                      t.exclude.push(u),
                      t.exclude.push(c)),
                R.KVArrayChecker(r.userData)
                    ? ((o = R.KVArrayChecker(r.userData)),
                      I(1005, o),
                      (n &= !1))
                    : (t.userData = w.KVArrayCopy(r.userData)),
                !!n && t
            )
        })(t)
    if (!L) return I(4e3), !1
    if (e.console) {
        var b = e.console.log,
            U = e.console.warn,
            j = e.console.error
        ;(e.console.log = function() {
            var r = [].slice.call(arguments)
            if (!r.length) return !0
            var t = w.composeScriptErrorData(
                257,
                r.join(', ').substr(0, 1e3),
                'via console.log',
                0,
                0,
                new Error(r.join(', ').substr(0, 1e3))
            )
            L.behaviour & l && i(p, t), b.apply(e.console, r)
        }),
            (e.console.warn = function() {
                var r = [].slice.call(arguments)
                if (!r.length) return !0
                var t = w.composeScriptErrorData(
                    258,
                    r.join(', ').substr(0, 1e3),
                    'via console.warn',
                    0,
                    0,
                    new Error(r.join(', ').substr(0, 1e3))
                )
                L.behaviour & l && i(p, t), U.apply(e.console, r)
            }),
            (e.console.error = function() {
                var r = [].slice.call(arguments)
                if (!r.length) return !0
                var t = w.composeScriptErrorData(
                    259,
                    r.join(', ').substr(0, 1e3),
                    'via console.error',
                    0,
                    0,
                    new Error(r.join(', ').substr(0, 1e3))
                )
                L.behaviour & l && i(p, t), j.apply(e.console, r)
            })
    }
    var T = e.XMLHttpRequest
    e.XMLHttpRequest = function() {
        var e = new T()
        return (
            (e._tracker_open = e.open),
            (e.tracker = {
                _time_init: 0,
                _time_open: 0,
                _time_send: 0,
                _time_load: 0,
                _time_done: 0,
                _request_method: '',
                _request_url: '',
                _status: ''
            }),
            e.addEventListener('error', a),
            e.addEventListener('timeout', a),
            e.addEventListener('readystatechange', a),
            (e.open = function(r, t, n, o, a) {
                return (
                    (e.tracker._request_method = r),
                    (e.tracker._request_url = t),
                    (e.tracker._time_open = w.getTime()),
                    e._tracker_open(r, t, n, o, a)
                )
            }),
            e
        )
    }
    var q = w.getGUID()
    e.addEventListener(
        'beforeunload',
        function(r) {
            if (e.performance && e.performance.timing && L.behaviour & d) {
                var t = {}
                ;(t.dns =
                    e.performance.timing.domainLookupEnd -
                    e.performance.timing.domainLookupStart),
                    (t.connect =
                        e.performance.timing.connectEnd -
                        e.performance.timing.connectStart),
                    (t.request =
                        e.performance.timing.responseStart -
                        e.performance.timing.requestStart),
                    (t.response =
                        e.performance.timing.responseEnd -
                        e.performance.timing.responseStart),
                    (t.dom =
                        e.performance.timing.domInteractive -
                        e.performance.timing.domLoading),
                    (t.domContent =
                        e.performance.timing.domComplete -
                        e.performance.timing.domInteractive),
                    (t.load =
                        e.performance.timing.domComplete -
                        e.performance.timing.domainLookupStart),
                    (t.view =
                        new Date().getTime() - e.performance.timing.domComplete)
                var n = w.composePerformaceData(E, t)
                i(E, n)
            }
        },
        !0
    ),
        e.addEventListener(
            'load',
            function(r) {
                if (e.performance && e.performance.timing && L.behaviour & d) {
                    var t = {}
                    ;(t.dns =
                        e.performance.timing.domainLookupEnd -
                        e.performance.timing.domainLookupStart),
                        (t.connect =
                            e.performance.timing.connectEnd -
                            e.performance.timing.connectStart),
                        (t.request =
                            e.performance.timing.responseStart -
                            e.performance.timing.requestStart),
                        (t.response =
                            e.performance.timing.responseEnd -
                            e.performance.timing.responseStart),
                        (t.dom =
                            e.performance.timing.domInteractive -
                            e.performance.timing.domLoading),
                        (t.domContent =
                            e.performance.timing.domComplete -
                            e.performance.timing.domInteractive),
                        (t.load =
                            e.performance.timing.domComplete -
                            e.performance.timing.domainLookupStart)
                    var n = w.composePerformaceData(E, t)
                    i(E, n)
                }
            },
            !0
        ),
        e.addEventListener('error', n, !0),
        r.addEventListener('error', o, !0),
        r.addEventListener('load', o, !0)
    var A = (function(e) {
        function r(e) {
            e.message || (e = new Error(e)),
                (e.error = e),
                (e.filename = e.filename ? e.filename : ''),
                (e.filename += ' via frontJS try - catch API'),
                (e.lineno = e.lineno ? e.lineno : 0),
                (e.colno = e.colno ? e.colno : 0),
                n(e)
        }
        return {
            try: function() {
                var e = arguments[0],
                    t = arguments[1]
                try {
                    e.apply(t, [].slice.call(arguments, 2))
                } catch (e) {
                    r(e)
                }
            },
            catch: r,
            composedTry: function(e, t) {
                return function() {
                    try {
                        e.apply(t, [].slice.call(arguments))
                    } catch (e) {
                        r(e)
                    }
                }
            },
            addUserData: function(r, t) {
                return (e.userData[r] = t), !0
            },
            removeUserData: function(r) {
                delete e.userData[r]
            }
        }
    })(L)
    return {
        C: { SCRIPT: l, RESOURCE: f, XHR: g, PERFOMACE: d },
        V: m,
        try: A.try,
        catch: A.catch,
        composedTry: A.composedTry,
        addUserData: A.addUserData,
        removeUserData: A.removeUserData
    }
})(window, document, window.reportjsConfig)
//# sourceMappingURL=tracker.min.js.map
